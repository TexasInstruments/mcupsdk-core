# Linker Command File Migration Guide {#LINKER_COMMAND_FILE_MIGRATION_GUIDE}

This section describes the differences between linker command file syntax of MCU+ SDK and Processor SDK RTOS (PDK).
This can be used as a migration aid when moving from Processor SDK RTOS (PDK) to MCU+ SDK.
Compiler used in MCU+ SDK is TIARMCLANG.
## API changes

To a large extent, linker command files for ARM applications that manage the placement of code
and data generated by the armcl compiler will also work with object files that are generated by the
tiarmclang compiler. However, below table mentions few adjustments that are needed to make your linker command file tiarmclang supportive.
It also lists down the sections which are no longer required in MCU+ SDK.

<table>
    <tr>
        <th> PDK(ARMCL)
        <th> MCU+ SDK(TIARMCLANG)
        <th> Remarks
    </tr>
    <tr>
        <td>.bootCode
        <td>None
        <td>No longer required in MCU+ SDK.
    </tr>
    <tr>
        <td>.startupCode
        <td>None
        <td>No longer required in MCU+ SDK.
    </tr>
    <tr>
        <td>.startupData
        <td>None
        <td>No longer required in MCU+ SDK.
    </tr>
    <tr>
        <td>.intvecs
        <td>None
        <td>No longer required in MCU+ SDK.
    </tr>
    <tr>
        <td>.intc_text
        <td>None
        <td>No longer required in MCU+ SDK.
    </tr>
    <tr>
        <td>.rstvectors
        <td>.vectors
        <td>
    </tr>
    <tr>
        <td>--entry_point=_resetvectors
        <td>e_vectors
        <td>R5F entry point and vector table
    </tr>
    <tr>
        <td>.const
        <td>.rodata
        <td>
    </tr>
</table>

## Important Notes

- In MCU+ SDK, R5F entry point, vector table, MUST be placed at 0x0 other than SBL
- User ISR code get called in context of SVC stack, so size of SVC stack MUST be kept large enough to handle worst case ISR requirement.
- The IRQ stack size itself can be kept small since it only saves few bytes (8 bytes) of state for every nested IRQ invocation.
- SDK default examples keep IRQ stack as 256 bytes and SVC stack size as 4096 bytes.
- This stack size is specified in the linker command file, a sample snippet is shown below,
\code
    __IRQ_STACK_SIZE = 256;
    /* This is the size of stack when R5 is in IRQ mode
    * - In both NORTOS and FreeRTOS nesting is disabled for FIQ
    */
    __FIQ_STACK_SIZE = 256;
    __SVC_STACK_SIZE = 4096; /* This is the size of stack when R5 is in SVC mode */
    __ABORT_STACK_SIZE = 256;  /* This is the size of stack when R5 is in ABORT mode */
    __UNDEFINED_STACK_SIZE = 256;  /* This is the size of stack when R5 is in UNDEF mode */
\endcode
- R5F boot code until MPU is enabled, MUST be at a address < 0x80000000 i.e this cannot be placed in DDR
\code
    GROUP {
        .text.hwi: palign(8)
        .text.cache: palign(8)
        .text.mpu: palign(8)
        .text.boot: palign(8)
        .text:abort: palign(8) /* this helps in loading symbols when using XIP mode */
    } > MSRAM
\endcode
- Below memory is reserved for DMSC usage. Security handoff is complete when this message is sent to the DMSC,
  TISCI_MSG_SEC_HANDOVER. This should be sent once all cores are loaded and all application specific firewall calls are setup.
\code
   During Boot till security handoff is complete
   0x701E0000 - 0x701FFFFF (128KB)
   After "Security Handoff" is complete (i.e at run time)
   0x701FC000 - 0x701FFFFF (16KB)
\endcode
- Please refer section "Shared memory logging" in \ref KERNEL_DPL_DEBUG_PAGE on shared memory segments.

## See Also

 - \ref KERNEL_FREERTOS_IMPORTANT_GUIDELINES_PAGE
 - \ref KERNEL_DPL_DEBUG_PAGE
 \cond SOC_AM64X || SOC_AM243X
 - \ref ICSS_EMAC
 \endcond
 - \ref BOOTFLOW_GUIDE
 \cond SOC_AM64X || SOC_AM243X
 - \ref BOOTFLOW_XIP
 \endcond
 - \ref BOOTFLOW_GUIDE
