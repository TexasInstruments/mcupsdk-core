/*
 *  Copyright (C) 2024 Texas Instruments Incorporated
 *
 *  Redistribution and use in source and binary forms, with or without
 *  modification, are permitted provided that the following conditions
 *  are met:
 *
 *    Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 *
 *    Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the
 *    distribution.
 *
 *    Neither the name of Texas Instruments Incorporated nor the names of
 *    its contributors may be used to endorse or promote products derived
 *    from this software without specific prior written permission.
 *
 *  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 *  "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 *  LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 *  A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 *  OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 *  SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 *  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 *  DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 *  THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 *  (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 *  OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#include "fastrts.h"
#include <stdint.h>
#include <math.h>

/* ========================================================================== */
/*                   Look-up Table Declarations                               */
/* ========================================================================== */

/** 
 *  @brief The Sine/Cosine Lookup Table
 */
const float FastRTS_SinCosTbl[];

/** 
 *  @brief The Arctangent Lookup Table
 */
const float FastRTS_Arctan2Tbl[];

/** 
 *  @brief The Exponent Lookup Table
 */
const float FastRTS_expTable[];

/** 
 *  @brief The Natural Logarithm Lookup Table
 */
const float FastRTS_logTable[];

/* ========================================================================== */
/*                                 Macros                                     */
/* ========================================================================== */

/** 
 *  @brief The Sine/Cosine Lookup Table size
 */
#define SINCOS_TBLSIZE    (512U)

/** @brief The Arctangent Lookup Table size
 *  @note The table is arranged as 3-tuples, there are ARCTAN2_TBLSIZE + 1 
 *  3-tuples
 */
#define ARCTAN2_TBLSIZE   (64U)

/** @brief The Natural Logarithm Lookup Table size
 *  @note The table is arranged as 3-tuples, there are LOG_TBLSIZE + 1 
 *  3-tuples
 */
#define LOG_TBLSIZE   (32U)

#define PI            (3.141592653589793f)
#define TWOPI         (6.283185307179586f)
#define PI_O_2        (1.570796326794897f)
#define THREEPI_O_2   (4.712388980384690f)
#define INVTWOPI      (0.159154943091895f)
#define ITABLE_SIZE   (1.0f/(float)SINCOS_TBLSIZE)
#define RAD_STEP      (TWOPI*ITABLE_SIZE)
#define RAD_ISTEP     ((float)SINCOS_TBLSIZE * INVTWOPI)

/** 
 *  Coefficient macros used in function
 */
#define SINCOS_A0   1.0f
#define SINCOS_A1   0.5f
#define SINCOS_A2   0.1666666667f
#define ASINCOS_A0  1.5707961728f
#define ASINCOS_A1  -0.2145852647f
#define ASINCOS_A2  0.0887556286f
#define ASINCOS_A3  -0.0488025043f
#define ASINCOS_A4  0.0268999482f
#define ASINCOS_A5  -0.0111462294f
#define ASINCOS_A6  0.0022959648f
#define FPUINV1     1.0000000000000f
#define FPUINV2     0.5000000000000f
#define FPUINV3     0.3333333333333f
#define FPUINV4     0.2500000000000f
#define FPUINV5     0.2000000000000f
#define FPUINV6     0.1666666666667f
#define FPUINV7     0.1428571428571f
#define FPULOG10    0.4342944819033f
#define FPULOG2             0.6931471805599f
#define FPUINVLOG10         0.4342944819033f
#define FPUEXPBIAS          127.00000000000f
#define FPULOG_TABLE_MASK1  0x3FFFFFFF
#define FPULOG_TABLE_MASK2  0x3F800000
#define FLT_MANT_DIG        24   /* BITS IN MANTISSA */

/* ========================================================================== */
/*                       Look up tables                                       */
/* ========================================================================== */

RTS_DATA_SECTION const float FastRTS_SinCosTbl[641] = {
     0.0000000000000,    // sin(2 * pi *    0/ 512)
     0.0122715382857,    // sin(2 * pi *    1/ 512)
     0.0245412285229,    // sin(2 * pi *    2/ 512)
     0.0368072229414,    // sin(2 * pi *    3/ 512)
     0.0490676743274,    // sin(2 * pi *    4/ 512)
     0.0613207363022,    // sin(2 * pi *    5/ 512)
     0.0735645635997,    // sin(2 * pi *    6/ 512)
     0.0857973123444,    // sin(2 * pi *    7/ 512)
     0.0980171403296,    // sin(2 * pi *    8/ 512)
     0.1102222072939,    // sin(2 * pi *    9/ 512)
     0.1224106751992,    // sin(2 * pi *   10/ 512)
     0.1345807085071,    // sin(2 * pi *   11/ 512)
     0.1467304744554,    // sin(2 * pi *   12/ 512)
     0.1588581433339,    // sin(2 * pi *   13/ 512)
     0.1709618887603,    // sin(2 * pi *   14/ 512)
     0.1830398879551,    // sin(2 * pi *   15/ 512)
     0.1950903220161,    // sin(2 * pi *   16/ 512)
     0.2071113761922,    // sin(2 * pi *   17/ 512)
     0.2191012401569,    // sin(2 * pi *   18/ 512)
     0.2310581082807,    // sin(2 * pi *   19/ 512)
     0.2429801799033,    // sin(2 * pi *   20/ 512)
     0.2548656596045,    // sin(2 * pi *   21/ 512)
     0.2667127574749,    // sin(2 * pi *   22/ 512)
     0.2785196893851,    // sin(2 * pi *   23/ 512)
     0.2902846772545,    // sin(2 * pi *   24/ 512)
     0.3020059493192,    // sin(2 * pi *   25/ 512)
     0.3136817403989,    // sin(2 * pi *   26/ 512)
     0.3253102921623,    // sin(2 * pi *   27/ 512)
     0.3368898533922,    // sin(2 * pi *   28/ 512)
     0.3484186802494,    // sin(2 * pi *   29/ 512)
     0.3598950365350,    // sin(2 * pi *   30/ 512)
     0.3713171939518,    // sin(2 * pi *   31/ 512)
     0.3826834323651,    // sin(2 * pi *   32/ 512)
     0.3939920400610,    // sin(2 * pi *   33/ 512)
     0.4052413140050,    // sin(2 * pi *   34/ 512)
     0.4164295600976,    // sin(2 * pi *   35/ 512)
     0.4275550934303,    // sin(2 * pi *   36/ 512)
     0.4386162385385,    // sin(2 * pi *   37/ 512)
     0.4496113296546,    // sin(2 * pi *   38/ 512)
     0.4605387109582,    // sin(2 * pi *   39/ 512)
     0.4713967368260,    // sin(2 * pi *   40/ 512)
     0.4821837720791,    // sin(2 * pi *   41/ 512)
     0.4928981922298,    // sin(2 * pi *   42/ 512)
     0.5035383837257,    // sin(2 * pi *   43/ 512)
     0.5141027441932,    // sin(2 * pi *   44/ 512)
     0.5245896826785,    // sin(2 * pi *   45/ 512)
     0.5349976198871,    // sin(2 * pi *   46/ 512)
     0.5453249884220,    // sin(2 * pi *   47/ 512)
     0.5555702330196,    // sin(2 * pi *   48/ 512)
     0.5657318107836,    // sin(2 * pi *   49/ 512)
     0.5758081914178,    // sin(2 * pi *   50/ 512)
     0.5857978574564,    // sin(2 * pi *   51/ 512)
     0.5956993044924,    // sin(2 * pi *   52/ 512)
     0.6055110414043,    // sin(2 * pi *   53/ 512)
     0.6152315905806,    // sin(2 * pi *   54/ 512)
     0.6248594881424,    // sin(2 * pi *   55/ 512)
     0.6343932841636,    // sin(2 * pi *   56/ 512)
     0.6438315428898,    // sin(2 * pi *   57/ 512)
     0.6531728429538,    // sin(2 * pi *   58/ 512)
     0.6624157775902,    // sin(2 * pi *   59/ 512)
     0.6715589548470,    // sin(2 * pi *   60/ 512)
     0.6806009977955,    // sin(2 * pi *   61/ 512)
     0.6895405447371,    // sin(2 * pi *   62/ 512)
     0.6983762494090,    // sin(2 * pi *   63/ 512)
     0.7071067811865,    // sin(2 * pi *   64/ 512)
     0.7157308252838,    // sin(2 * pi *   65/ 512)
     0.7242470829515,    // sin(2 * pi *   66/ 512)
     0.7326542716724,    // sin(2 * pi *   67/ 512)
     0.7409511253550,    // sin(2 * pi *   68/ 512)
     0.7491363945235,    // sin(2 * pi *   69/ 512)
     0.7572088465065,    // sin(2 * pi *   70/ 512)
     0.7651672656225,    // sin(2 * pi *   71/ 512)
     0.7730104533627,    // sin(2 * pi *   72/ 512)
     0.7807372285721,    // sin(2 * pi *   73/ 512)
     0.7883464276266,    // sin(2 * pi *   74/ 512)
     0.7958369046089,    // sin(2 * pi *   75/ 512)
     0.8032075314806,    // sin(2 * pi *   76/ 512)
     0.8104571982526,    // sin(2 * pi *   77/ 512)
     0.8175848131516,    // sin(2 * pi *   78/ 512)
     0.8245893027850,    // sin(2 * pi *   79/ 512)
     0.8314696123025,    // sin(2 * pi *   80/ 512)
     0.8382247055548,    // sin(2 * pi *   81/ 512)
     0.8448535652497,    // sin(2 * pi *   82/ 512)
     0.8513551931053,    // sin(2 * pi *   83/ 512)
     0.8577286100003,    // sin(2 * pi *   84/ 512)
     0.8639728561216,    // sin(2 * pi *   85/ 512)
     0.8700869911087,    // sin(2 * pi *   86/ 512)
     0.8760700941954,    // sin(2 * pi *   87/ 512)
     0.8819212643484,    // sin(2 * pi *   88/ 512)
     0.8876396204029,    // sin(2 * pi *   89/ 512)
     0.8932243011955,    // sin(2 * pi *   90/ 512)
     0.8986744656940,    // sin(2 * pi *   91/ 512)
     0.9039892931234,    // sin(2 * pi *   92/ 512)
     0.9091679830905,    // sin(2 * pi *   93/ 512)
     0.9142097557035,    // sin(2 * pi *   94/ 512)
     0.9191138516901,    // sin(2 * pi *   95/ 512)
     0.9238795325113,    // sin(2 * pi *   96/ 512)
     0.9285060804732,    // sin(2 * pi *   97/ 512)
     0.9329927988347,    // sin(2 * pi *   98/ 512)
     0.9373390119126,    // sin(2 * pi *   99/ 512)
     0.9415440651830,    // sin(2 * pi *  100/ 512)
     0.9456073253805,    // sin(2 * pi *  101/ 512)
     0.9495281805930,    // sin(2 * pi *  102/ 512)
     0.9533060403542,    // sin(2 * pi *  103/ 512)
     0.9569403357322,    // sin(2 * pi *  104/ 512)
     0.9604305194156,    // sin(2 * pi *  105/ 512)
     0.9637760657954,    // sin(2 * pi *  106/ 512)
     0.9669764710449,    // sin(2 * pi *  107/ 512)
     0.9700312531945,    // sin(2 * pi *  108/ 512)
     0.9729399522056,    // sin(2 * pi *  109/ 512)
     0.9757021300385,    // sin(2 * pi *  110/ 512)
     0.9783173707196,    // sin(2 * pi *  111/ 512)
     0.9807852804032,    // sin(2 * pi *  112/ 512)
     0.9831054874312,    // sin(2 * pi *  113/ 512)
     0.9852776423889,    // sin(2 * pi *  114/ 512)
     0.9873014181579,    // sin(2 * pi *  115/ 512)
     0.9891765099648,    // sin(2 * pi *  116/ 512)
     0.9909026354278,    // sin(2 * pi *  117/ 512)
     0.9924795345987,    // sin(2 * pi *  118/ 512)
     0.9939069700024,    // sin(2 * pi *  119/ 512)
     0.9951847266722,    // sin(2 * pi *  120/ 512)
     0.9963126121828,    // sin(2 * pi *  121/ 512)
     0.9972904566787,    // sin(2 * pi *  122/ 512)
     0.9981181129001,    // sin(2 * pi *  123/ 512)
     0.9987954562052,    // sin(2 * pi *  124/ 512)
     0.9993223845883,    // sin(2 * pi *  125/ 512)
     0.9996988186962,    // sin(2 * pi *  126/ 512)
     0.9999247018391,    // sin(2 * pi *  127/ 512)
     1.0000000000000,    // sin(2 * pi *  128/ 512)
     0.9999247018391,    // sin(2 * pi *  129/ 512)
     0.9996988186962,    // sin(2 * pi *  130/ 512)
     0.9993223845883,    // sin(2 * pi *  131/ 512)
     0.9987954562052,    // sin(2 * pi *  132/ 512)
     0.9981181129001,    // sin(2 * pi *  133/ 512)
     0.9972904566787,    // sin(2 * pi *  134/ 512)
     0.9963126121828,    // sin(2 * pi *  135/ 512)
     0.9951847266722,    // sin(2 * pi *  136/ 512)
     0.9939069700024,    // sin(2 * pi *  137/ 512)
     0.9924795345987,    // sin(2 * pi *  138/ 512)
     0.9909026354278,    // sin(2 * pi *  139/ 512)
     0.9891765099648,    // sin(2 * pi *  140/ 512)
     0.9873014181579,    // sin(2 * pi *  141/ 512)
     0.9852776423889,    // sin(2 * pi *  142/ 512)
     0.9831054874312,    // sin(2 * pi *  143/ 512)
     0.9807852804032,    // sin(2 * pi *  144/ 512)
     0.9783173707196,    // sin(2 * pi *  145/ 512)
     0.9757021300385,    // sin(2 * pi *  146/ 512)
     0.9729399522056,    // sin(2 * pi *  147/ 512)
     0.9700312531945,    // sin(2 * pi *  148/ 512)
     0.9669764710449,    // sin(2 * pi *  149/ 512)
     0.9637760657954,    // sin(2 * pi *  150/ 512)
     0.9604305194156,    // sin(2 * pi *  151/ 512)
     0.9569403357322,    // sin(2 * pi *  152/ 512)
     0.9533060403542,    // sin(2 * pi *  153/ 512)
     0.9495281805930,    // sin(2 * pi *  154/ 512)
     0.9456073253805,    // sin(2 * pi *  155/ 512)
     0.9415440651830,    // sin(2 * pi *  156/ 512)
     0.9373390119126,    // sin(2 * pi *  157/ 512)
     0.9329927988347,    // sin(2 * pi *  158/ 512)
     0.9285060804732,    // sin(2 * pi *  159/ 512)
     0.9238795325113,    // sin(2 * pi *  160/ 512)
     0.9191138516901,    // sin(2 * pi *  161/ 512)
     0.9142097557035,    // sin(2 * pi *  162/ 512)
     0.9091679830905,    // sin(2 * pi *  163/ 512)
     0.9039892931234,    // sin(2 * pi *  164/ 512)
     0.8986744656940,    // sin(2 * pi *  165/ 512)
     0.8932243011955,    // sin(2 * pi *  166/ 512)
     0.8876396204029,    // sin(2 * pi *  167/ 512)
     0.8819212643484,    // sin(2 * pi *  168/ 512)
     0.8760700941954,    // sin(2 * pi *  169/ 512)
     0.8700869911087,    // sin(2 * pi *  170/ 512)
     0.8639728561216,    // sin(2 * pi *  171/ 512)
     0.8577286100003,    // sin(2 * pi *  172/ 512)
     0.8513551931053,    // sin(2 * pi *  173/ 512)
     0.8448535652497,    // sin(2 * pi *  174/ 512)
     0.8382247055548,    // sin(2 * pi *  175/ 512)
     0.8314696123025,    // sin(2 * pi *  176/ 512)
     0.8245893027850,    // sin(2 * pi *  177/ 512)
     0.8175848131516,    // sin(2 * pi *  178/ 512)
     0.8104571982526,    // sin(2 * pi *  179/ 512)
     0.8032075314806,    // sin(2 * pi *  180/ 512)
     0.7958369046089,    // sin(2 * pi *  181/ 512)
     0.7883464276266,    // sin(2 * pi *  182/ 512)
     0.7807372285721,    // sin(2 * pi *  183/ 512)
     0.7730104533627,    // sin(2 * pi *  184/ 512)
     0.7651672656225,    // sin(2 * pi *  185/ 512)
     0.7572088465065,    // sin(2 * pi *  186/ 512)
     0.7491363945235,    // sin(2 * pi *  187/ 512)
     0.7409511253550,    // sin(2 * pi *  188/ 512)
     0.7326542716724,    // sin(2 * pi *  189/ 512)
     0.7242470829515,    // sin(2 * pi *  190/ 512)
     0.7157308252838,    // sin(2 * pi *  191/ 512)
     0.7071067811865,    // sin(2 * pi *  192/ 512)
     0.6983762494090,    // sin(2 * pi *  193/ 512)
     0.6895405447371,    // sin(2 * pi *  194/ 512)
     0.6806009977955,    // sin(2 * pi *  195/ 512)
     0.6715589548470,    // sin(2 * pi *  196/ 512)
     0.6624157775902,    // sin(2 * pi *  197/ 512)
     0.6531728429538,    // sin(2 * pi *  198/ 512)
     0.6438315428898,    // sin(2 * pi *  199/ 512)
     0.6343932841636,    // sin(2 * pi *  200/ 512)
     0.6248594881424,    // sin(2 * pi *  201/ 512)
     0.6152315905806,    // sin(2 * pi *  202/ 512)
     0.6055110414043,    // sin(2 * pi *  203/ 512)
     0.5956993044924,    // sin(2 * pi *  204/ 512)
     0.5857978574564,    // sin(2 * pi *  205/ 512)
     0.5758081914178,    // sin(2 * pi *  206/ 512)
     0.5657318107836,    // sin(2 * pi *  207/ 512)
     0.5555702330196,    // sin(2 * pi *  208/ 512)
     0.5453249884220,    // sin(2 * pi *  209/ 512)
     0.5349976198871,    // sin(2 * pi *  210/ 512)
     0.5245896826785,    // sin(2 * pi *  211/ 512)
     0.5141027441932,    // sin(2 * pi *  212/ 512)
     0.5035383837257,    // sin(2 * pi *  213/ 512)
     0.4928981922298,    // sin(2 * pi *  214/ 512)
     0.4821837720791,    // sin(2 * pi *  215/ 512)
     0.4713967368260,    // sin(2 * pi *  216/ 512)
     0.4605387109582,    // sin(2 * pi *  217/ 512)
     0.4496113296546,    // sin(2 * pi *  218/ 512)
     0.4386162385385,    // sin(2 * pi *  219/ 512)
     0.4275550934303,    // sin(2 * pi *  220/ 512)
     0.4164295600976,    // sin(2 * pi *  221/ 512)
     0.4052413140050,    // sin(2 * pi *  222/ 512)
     0.3939920400610,    // sin(2 * pi *  223/ 512)
     0.3826834323651,    // sin(2 * pi *  224/ 512)
     0.3713171939518,    // sin(2 * pi *  225/ 512)
     0.3598950365350,    // sin(2 * pi *  226/ 512)
     0.3484186802494,    // sin(2 * pi *  227/ 512)
     0.3368898533922,    // sin(2 * pi *  228/ 512)
     0.3253102921623,    // sin(2 * pi *  229/ 512)
     0.3136817403989,    // sin(2 * pi *  230/ 512)
     0.3020059493192,    // sin(2 * pi *  231/ 512)
     0.2902846772545,    // sin(2 * pi *  232/ 512)
     0.2785196893851,    // sin(2 * pi *  233/ 512)
     0.2667127574749,    // sin(2 * pi *  234/ 512)
     0.2548656596045,    // sin(2 * pi *  235/ 512)
     0.2429801799033,    // sin(2 * pi *  236/ 512)
     0.2310581082807,    // sin(2 * pi *  237/ 512)
     0.2191012401569,    // sin(2 * pi *  238/ 512)
     0.2071113761922,    // sin(2 * pi *  239/ 512)
     0.1950903220161,    // sin(2 * pi *  240/ 512)
     0.1830398879551,    // sin(2 * pi *  241/ 512)
     0.1709618887603,    // sin(2 * pi *  242/ 512)
     0.1588581433339,    // sin(2 * pi *  243/ 512)
     0.1467304744554,    // sin(2 * pi *  244/ 512)
     0.1345807085071,    // sin(2 * pi *  245/ 512)
     0.1224106751992,    // sin(2 * pi *  246/ 512)
     0.1102222072939,    // sin(2 * pi *  247/ 512)
     0.0980171403296,    // sin(2 * pi *  248/ 512)
     0.0857973123444,    // sin(2 * pi *  249/ 512)
     0.0735645635997,    // sin(2 * pi *  250/ 512)
     0.0613207363022,    // sin(2 * pi *  251/ 512)
     0.0490676743274,    // sin(2 * pi *  252/ 512)
     0.0368072229414,    // sin(2 * pi *  253/ 512)
     0.0245412285229,    // sin(2 * pi *  254/ 512)
     0.0122715382857,    // sin(2 * pi *  255/ 512)
     0.0000000000000,    // sin(2 * pi *  256/ 512)
    -0.0122715382857,    // sin(2 * pi *  257/ 512)
    -0.0245412285229,    // sin(2 * pi *  258/ 512)
    -0.0368072229414,    // sin(2 * pi *  259/ 512)
    -0.0490676743274,    // sin(2 * pi *  260/ 512)
    -0.0613207363022,    // sin(2 * pi *  261/ 512)
    -0.0735645635997,    // sin(2 * pi *  262/ 512)
    -0.0857973123444,    // sin(2 * pi *  263/ 512)
    -0.0980171403296,    // sin(2 * pi *  264/ 512)
    -0.1102222072939,    // sin(2 * pi *  265/ 512)
    -0.1224106751992,    // sin(2 * pi *  266/ 512)
    -0.1345807085071,    // sin(2 * pi *  267/ 512)
    -0.1467304744554,    // sin(2 * pi *  268/ 512)
    -0.1588581433339,    // sin(2 * pi *  269/ 512)
    -0.1709618887603,    // sin(2 * pi *  270/ 512)
    -0.1830398879551,    // sin(2 * pi *  271/ 512)
    -0.1950903220161,    // sin(2 * pi *  272/ 512)
    -0.2071113761922,    // sin(2 * pi *  273/ 512)
    -0.2191012401569,    // sin(2 * pi *  274/ 512)
    -0.2310581082807,    // sin(2 * pi *  275/ 512)
    -0.2429801799033,    // sin(2 * pi *  276/ 512)
    -0.2548656596045,    // sin(2 * pi *  277/ 512)
    -0.2667127574749,    // sin(2 * pi *  278/ 512)
    -0.2785196893851,    // sin(2 * pi *  279/ 512)
    -0.2902846772545,    // sin(2 * pi *  280/ 512)
    -0.3020059493192,    // sin(2 * pi *  281/ 512)
    -0.3136817403989,    // sin(2 * pi *  282/ 512)
    -0.3253102921623,    // sin(2 * pi *  283/ 512)
    -0.3368898533922,    // sin(2 * pi *  284/ 512)
    -0.3484186802494,    // sin(2 * pi *  285/ 512)
    -0.3598950365350,    // sin(2 * pi *  286/ 512)
    -0.3713171939518,    // sin(2 * pi *  287/ 512)
    -0.3826834323651,    // sin(2 * pi *  288/ 512)
    -0.3939920400610,    // sin(2 * pi *  289/ 512)
    -0.4052413140050,    // sin(2 * pi *  290/ 512)
    -0.4164295600976,    // sin(2 * pi *  291/ 512)
    -0.4275550934303,    // sin(2 * pi *  292/ 512)
    -0.4386162385385,    // sin(2 * pi *  293/ 512)
    -0.4496113296546,    // sin(2 * pi *  294/ 512)
    -0.4605387109582,    // sin(2 * pi *  295/ 512)
    -0.4713967368260,    // sin(2 * pi *  296/ 512)
    -0.4821837720791,    // sin(2 * pi *  297/ 512)
    -0.4928981922298,    // sin(2 * pi *  298/ 512)
    -0.5035383837257,    // sin(2 * pi *  299/ 512)
    -0.5141027441932,    // sin(2 * pi *  300/ 512)
    -0.5245896826785,    // sin(2 * pi *  301/ 512)
    -0.5349976198871,    // sin(2 * pi *  302/ 512)
    -0.5453249884220,    // sin(2 * pi *  303/ 512)
    -0.5555702330196,    // sin(2 * pi *  304/ 512)
    -0.5657318107836,    // sin(2 * pi *  305/ 512)
    -0.5758081914178,    // sin(2 * pi *  306/ 512)
    -0.5857978574564,    // sin(2 * pi *  307/ 512)
    -0.5956993044924,    // sin(2 * pi *  308/ 512)
    -0.6055110414043,    // sin(2 * pi *  309/ 512)
    -0.6152315905806,    // sin(2 * pi *  310/ 512)
    -0.6248594881424,    // sin(2 * pi *  311/ 512)
    -0.6343932841636,    // sin(2 * pi *  312/ 512)
    -0.6438315428898,    // sin(2 * pi *  313/ 512)
    -0.6531728429538,    // sin(2 * pi *  314/ 512)
    -0.6624157775902,    // sin(2 * pi *  315/ 512)
    -0.6715589548470,    // sin(2 * pi *  316/ 512)
    -0.6806009977955,    // sin(2 * pi *  317/ 512)
    -0.6895405447371,    // sin(2 * pi *  318/ 512)
    -0.6983762494090,    // sin(2 * pi *  319/ 512)
    -0.7071067811865,    // sin(2 * pi *  320/ 512)
    -0.7157308252838,    // sin(2 * pi *  321/ 512)
    -0.7242470829515,    // sin(2 * pi *  322/ 512)
    -0.7326542716724,    // sin(2 * pi *  323/ 512)
    -0.7409511253550,    // sin(2 * pi *  324/ 512)
    -0.7491363945235,    // sin(2 * pi *  325/ 512)
    -0.7572088465065,    // sin(2 * pi *  326/ 512)
    -0.7651672656225,    // sin(2 * pi *  327/ 512)
    -0.7730104533627,    // sin(2 * pi *  328/ 512)
    -0.7807372285721,    // sin(2 * pi *  329/ 512)
    -0.7883464276266,    // sin(2 * pi *  330/ 512)
    -0.7958369046089,    // sin(2 * pi *  331/ 512)
    -0.8032075314806,    // sin(2 * pi *  332/ 512)
    -0.8104571982526,    // sin(2 * pi *  333/ 512)
    -0.8175848131516,    // sin(2 * pi *  334/ 512)
    -0.8245893027850,    // sin(2 * pi *  335/ 512)
    -0.8314696123025,    // sin(2 * pi *  336/ 512)
    -0.8382247055548,    // sin(2 * pi *  337/ 512)
    -0.8448535652497,    // sin(2 * pi *  338/ 512)
    -0.8513551931053,    // sin(2 * pi *  339/ 512)
    -0.8577286100003,    // sin(2 * pi *  340/ 512)
    -0.8639728561216,    // sin(2 * pi *  341/ 512)
    -0.8700869911087,    // sin(2 * pi *  342/ 512)
    -0.8760700941954,    // sin(2 * pi *  343/ 512)
    -0.8819212643484,    // sin(2 * pi *  344/ 512)
    -0.8876396204029,    // sin(2 * pi *  345/ 512)
    -0.8932243011955,    // sin(2 * pi *  346/ 512)
    -0.8986744656940,    // sin(2 * pi *  347/ 512)
    -0.9039892931234,    // sin(2 * pi *  348/ 512)
    -0.9091679830905,    // sin(2 * pi *  349/ 512)
    -0.9142097557035,    // sin(2 * pi *  350/ 512)
    -0.9191138516901,    // sin(2 * pi *  351/ 512)
    -0.9238795325113,    // sin(2 * pi *  352/ 512)
    -0.9285060804732,    // sin(2 * pi *  353/ 512)
    -0.9329927988347,    // sin(2 * pi *  354/ 512)
    -0.9373390119126,    // sin(2 * pi *  355/ 512)
    -0.9415440651830,    // sin(2 * pi *  356/ 512)
    -0.9456073253805,    // sin(2 * pi *  357/ 512)
    -0.9495281805930,    // sin(2 * pi *  358/ 512)
    -0.9533060403542,    // sin(2 * pi *  359/ 512)
    -0.9569403357322,    // sin(2 * pi *  360/ 512)
    -0.9604305194156,    // sin(2 * pi *  361/ 512)
    -0.9637760657954,    // sin(2 * pi *  362/ 512)
    -0.9669764710449,    // sin(2 * pi *  363/ 512)
    -0.9700312531945,    // sin(2 * pi *  364/ 512)
    -0.9729399522056,    // sin(2 * pi *  365/ 512)
    -0.9757021300385,    // sin(2 * pi *  366/ 512)
    -0.9783173707196,    // sin(2 * pi *  367/ 512)
    -0.9807852804032,    // sin(2 * pi *  368/ 512)
    -0.9831054874312,    // sin(2 * pi *  369/ 512)
    -0.9852776423889,    // sin(2 * pi *  370/ 512)
    -0.9873014181579,    // sin(2 * pi *  371/ 512)
    -0.9891765099648,    // sin(2 * pi *  372/ 512)
    -0.9909026354278,    // sin(2 * pi *  373/ 512)
    -0.9924795345987,    // sin(2 * pi *  374/ 512)
    -0.9939069700024,    // sin(2 * pi *  375/ 512)
    -0.9951847266722,    // sin(2 * pi *  376/ 512)
    -0.9963126121828,    // sin(2 * pi *  377/ 512)
    -0.9972904566787,    // sin(2 * pi *  378/ 512)
    -0.9981181129001,    // sin(2 * pi *  379/ 512)
    -0.9987954562052,    // sin(2 * pi *  380/ 512)
    -0.9993223845883,    // sin(2 * pi *  381/ 512)
    -0.9996988186962,    // sin(2 * pi *  382/ 512)
    -0.9999247018391,    // sin(2 * pi *  383/ 512)
    -1.0000000000000,    // sin(2 * pi *  384/ 512)
    -0.9999247018391,    // sin(2 * pi *  385/ 512)
    -0.9996988186962,    // sin(2 * pi *  386/ 512)
    -0.9993223845883,    // sin(2 * pi *  387/ 512)
    -0.9987954562052,    // sin(2 * pi *  388/ 512)
    -0.9981181129001,    // sin(2 * pi *  389/ 512)
    -0.9972904566787,    // sin(2 * pi *  390/ 512)
    -0.9963126121828,    // sin(2 * pi *  391/ 512)
    -0.9951847266722,    // sin(2 * pi *  392/ 512)
    -0.9939069700024,    // sin(2 * pi *  393/ 512)
    -0.9924795345987,    // sin(2 * pi *  394/ 512)
    -0.9909026354278,    // sin(2 * pi *  395/ 512)
    -0.9891765099648,    // sin(2 * pi *  396/ 512)
    -0.9873014181579,    // sin(2 * pi *  397/ 512)
    -0.9852776423889,    // sin(2 * pi *  398/ 512)
    -0.9831054874312,    // sin(2 * pi *  399/ 512)
    -0.9807852804032,    // sin(2 * pi *  400/ 512)
    -0.9783173707196,    // sin(2 * pi *  401/ 512)
    -0.9757021300385,    // sin(2 * pi *  402/ 512)
    -0.9729399522056,    // sin(2 * pi *  403/ 512)
    -0.9700312531945,    // sin(2 * pi *  404/ 512)
    -0.9669764710449,    // sin(2 * pi *  405/ 512)
    -0.9637760657954,    // sin(2 * pi *  406/ 512)
    -0.9604305194156,    // sin(2 * pi *  407/ 512)
    -0.9569403357322,    // sin(2 * pi *  408/ 512)
    -0.9533060403542,    // sin(2 * pi *  409/ 512)
    -0.9495281805930,    // sin(2 * pi *  410/ 512)
    -0.9456073253805,    // sin(2 * pi *  411/ 512)
    -0.9415440651830,    // sin(2 * pi *  412/ 512)
    -0.9373390119126,    // sin(2 * pi *  413/ 512)
    -0.9329927988347,    // sin(2 * pi *  414/ 512)
    -0.9285060804732,    // sin(2 * pi *  415/ 512)
    -0.9238795325113,    // sin(2 * pi *  416/ 512)
    -0.9191138516901,    // sin(2 * pi *  417/ 512)
    -0.9142097557035,    // sin(2 * pi *  418/ 512)
    -0.9091679830905,    // sin(2 * pi *  419/ 512)
    -0.9039892931234,    // sin(2 * pi *  420/ 512)
    -0.8986744656940,    // sin(2 * pi *  421/ 512)
    -0.8932243011955,    // sin(2 * pi *  422/ 512)
    -0.8876396204029,    // sin(2 * pi *  423/ 512)
    -0.8819212643484,    // sin(2 * pi *  424/ 512)
    -0.8760700941954,    // sin(2 * pi *  425/ 512)
    -0.8700869911087,    // sin(2 * pi *  426/ 512)
    -0.8639728561216,    // sin(2 * pi *  427/ 512)
    -0.8577286100003,    // sin(2 * pi *  428/ 512)
    -0.8513551931053,    // sin(2 * pi *  429/ 512)
    -0.8448535652497,    // sin(2 * pi *  430/ 512)
    -0.8382247055548,    // sin(2 * pi *  431/ 512)
    -0.8314696123025,    // sin(2 * pi *  432/ 512)
    -0.8245893027850,    // sin(2 * pi *  433/ 512)
    -0.8175848131516,    // sin(2 * pi *  434/ 512)
    -0.8104571982526,    // sin(2 * pi *  435/ 512)
    -0.8032075314806,    // sin(2 * pi *  436/ 512)
    -0.7958369046089,    // sin(2 * pi *  437/ 512)
    -0.7883464276266,    // sin(2 * pi *  438/ 512)
    -0.7807372285721,    // sin(2 * pi *  439/ 512)
    -0.7730104533627,    // sin(2 * pi *  440/ 512)
    -0.7651672656225,    // sin(2 * pi *  441/ 512)
    -0.7572088465065,    // sin(2 * pi *  442/ 512)
    -0.7491363945235,    // sin(2 * pi *  443/ 512)
    -0.7409511253550,    // sin(2 * pi *  444/ 512)
    -0.7326542716724,    // sin(2 * pi *  445/ 512)
    -0.7242470829515,    // sin(2 * pi *  446/ 512)
    -0.7157308252838,    // sin(2 * pi *  447/ 512)
    -0.7071067811865,    // sin(2 * pi *  448/ 512)
    -0.6983762494090,    // sin(2 * pi *  449/ 512)
    -0.6895405447371,    // sin(2 * pi *  450/ 512)
    -0.6806009977955,    // sin(2 * pi *  451/ 512)
    -0.6715589548470,    // sin(2 * pi *  452/ 512)
    -0.6624157775902,    // sin(2 * pi *  453/ 512)
    -0.6531728429538,    // sin(2 * pi *  454/ 512)
    -0.6438315428898,    // sin(2 * pi *  455/ 512)
    -0.6343932841636,    // sin(2 * pi *  456/ 512)
    -0.6248594881424,    // sin(2 * pi *  457/ 512)
    -0.6152315905806,    // sin(2 * pi *  458/ 512)
    -0.6055110414043,    // sin(2 * pi *  459/ 512)
    -0.5956993044924,    // sin(2 * pi *  460/ 512)
    -0.5857978574564,    // sin(2 * pi *  461/ 512)
    -0.5758081914178,    // sin(2 * pi *  462/ 512)
    -0.5657318107836,    // sin(2 * pi *  463/ 512)
    -0.5555702330196,    // sin(2 * pi *  464/ 512)
    -0.5453249884220,    // sin(2 * pi *  465/ 512)
    -0.5349976198871,    // sin(2 * pi *  466/ 512)
    -0.5245896826785,    // sin(2 * pi *  467/ 512)
    -0.5141027441932,    // sin(2 * pi *  468/ 512)
    -0.5035383837257,    // sin(2 * pi *  469/ 512)
    -0.4928981922298,    // sin(2 * pi *  470/ 512)
    -0.4821837720791,    // sin(2 * pi *  471/ 512)
    -0.4713967368260,    // sin(2 * pi *  472/ 512)
    -0.4605387109582,    // sin(2 * pi *  473/ 512)
    -0.4496113296546,    // sin(2 * pi *  474/ 512)
    -0.4386162385385,    // sin(2 * pi *  475/ 512)
    -0.4275550934303,    // sin(2 * pi *  476/ 512)
    -0.4164295600976,    // sin(2 * pi *  477/ 512)
    -0.4052413140050,    // sin(2 * pi *  478/ 512)
    -0.3939920400610,    // sin(2 * pi *  479/ 512)
    -0.3826834323651,    // sin(2 * pi *  480/ 512)
    -0.3713171939518,    // sin(2 * pi *  481/ 512)
    -0.3598950365350,    // sin(2 * pi *  482/ 512)
    -0.3484186802494,    // sin(2 * pi *  483/ 512)
    -0.3368898533922,    // sin(2 * pi *  484/ 512)
    -0.3253102921623,    // sin(2 * pi *  485/ 512)
    -0.3136817403989,    // sin(2 * pi *  486/ 512)
    -0.3020059493192,    // sin(2 * pi *  487/ 512)
    -0.2902846772545,    // sin(2 * pi *  488/ 512)
    -0.2785196893851,    // sin(2 * pi *  489/ 512)
    -0.2667127574749,    // sin(2 * pi *  490/ 512)
    -0.2548656596045,    // sin(2 * pi *  491/ 512)
    -0.2429801799033,    // sin(2 * pi *  492/ 512)
    -0.2310581082807,    // sin(2 * pi *  493/ 512)
    -0.2191012401569,    // sin(2 * pi *  494/ 512)
    -0.2071113761922,    // sin(2 * pi *  495/ 512)
    -0.1950903220161,    // sin(2 * pi *  496/ 512)
    -0.1830398879551,    // sin(2 * pi *  497/ 512)
    -0.1709618887603,    // sin(2 * pi *  498/ 512)
    -0.1588581433339,    // sin(2 * pi *  499/ 512)
    -0.1467304744554,    // sin(2 * pi *  500/ 512)
    -0.1345807085071,    // sin(2 * pi *  501/ 512)
    -0.1224106751992,    // sin(2 * pi *  502/ 512)
    -0.1102222072939,    // sin(2 * pi *  503/ 512)
    -0.0980171403296,    // sin(2 * pi *  504/ 512)
    -0.0857973123444,    // sin(2 * pi *  505/ 512)
    -0.0735645635997,    // sin(2 * pi *  506/ 512)
    -0.0613207363022,    // sin(2 * pi *  507/ 512)
    -0.0490676743274,    // sin(2 * pi *  508/ 512)
    -0.0368072229414,    // sin(2 * pi *  509/ 512)
    -0.0245412285229,    // sin(2 * pi *  510/ 512)
    -0.0122715382857,    // sin(2 * pi *  511/ 512)
    -0.0000000000000,    // sin(2 * pi *  512/ 512)
     0.0122715382857,    // sin(2 * pi *  513/ 512)
     0.0245412285229,    // sin(2 * pi *  514/ 512)
     0.0368072229414,    // sin(2 * pi *  515/ 512)
     0.0490676743274,    // sin(2 * pi *  516/ 512)
     0.0613207363022,    // sin(2 * pi *  517/ 512)
     0.0735645635997,    // sin(2 * pi *  518/ 512)
     0.0857973123444,    // sin(2 * pi *  519/ 512)
     0.0980171403296,    // sin(2 * pi *  520/ 512)
     0.1102222072939,    // sin(2 * pi *  521/ 512)
     0.1224106751992,    // sin(2 * pi *  522/ 512)
     0.1345807085071,    // sin(2 * pi *  523/ 512)
     0.1467304744554,    // sin(2 * pi *  524/ 512)
     0.1588581433339,    // sin(2 * pi *  525/ 512)
     0.1709618887603,    // sin(2 * pi *  526/ 512)
     0.1830398879551,    // sin(2 * pi *  527/ 512)
     0.1950903220161,    // sin(2 * pi *  528/ 512)
     0.2071113761922,    // sin(2 * pi *  529/ 512)
     0.2191012401569,    // sin(2 * pi *  530/ 512)
     0.2310581082807,    // sin(2 * pi *  531/ 512)
     0.2429801799033,    // sin(2 * pi *  532/ 512)
     0.2548656596045,    // sin(2 * pi *  533/ 512)
     0.2667127574749,    // sin(2 * pi *  534/ 512)
     0.2785196893851,    // sin(2 * pi *  535/ 512)
     0.2902846772545,    // sin(2 * pi *  536/ 512)
     0.3020059493192,    // sin(2 * pi *  537/ 512)
     0.3136817403989,    // sin(2 * pi *  538/ 512)
     0.3253102921623,    // sin(2 * pi *  539/ 512)
     0.3368898533922,    // sin(2 * pi *  540/ 512)
     0.3484186802494,    // sin(2 * pi *  541/ 512)
     0.3598950365350,    // sin(2 * pi *  542/ 512)
     0.3713171939518,    // sin(2 * pi *  543/ 512)
     0.3826834323651,    // sin(2 * pi *  544/ 512)
     0.3939920400610,    // sin(2 * pi *  545/ 512)
     0.4052413140050,    // sin(2 * pi *  546/ 512)
     0.4164295600976,    // sin(2 * pi *  547/ 512)
     0.4275550934303,    // sin(2 * pi *  548/ 512)
     0.4386162385385,    // sin(2 * pi *  549/ 512)
     0.4496113296546,    // sin(2 * pi *  550/ 512)
     0.4605387109582,    // sin(2 * pi *  551/ 512)
     0.4713967368260,    // sin(2 * pi *  552/ 512)
     0.4821837720791,    // sin(2 * pi *  553/ 512)
     0.4928981922298,    // sin(2 * pi *  554/ 512)
     0.5035383837257,    // sin(2 * pi *  555/ 512)
     0.5141027441932,    // sin(2 * pi *  556/ 512)
     0.5245896826785,    // sin(2 * pi *  557/ 512)
     0.5349976198871,    // sin(2 * pi *  558/ 512)
     0.5453249884220,    // sin(2 * pi *  559/ 512)
     0.5555702330196,    // sin(2 * pi *  560/ 512)
     0.5657318107836,    // sin(2 * pi *  561/ 512)
     0.5758081914178,    // sin(2 * pi *  562/ 512)
     0.5857978574564,    // sin(2 * pi *  563/ 512)
     0.5956993044924,    // sin(2 * pi *  564/ 512)
     0.6055110414043,    // sin(2 * pi *  565/ 512)
     0.6152315905806,    // sin(2 * pi *  566/ 512)
     0.6248594881424,    // sin(2 * pi *  567/ 512)
     0.6343932841636,    // sin(2 * pi *  568/ 512)
     0.6438315428898,    // sin(2 * pi *  569/ 512)
     0.6531728429538,    // sin(2 * pi *  570/ 512)
     0.6624157775902,    // sin(2 * pi *  571/ 512)
     0.6715589548470,    // sin(2 * pi *  572/ 512)
     0.6806009977955,    // sin(2 * pi *  573/ 512)
     0.6895405447371,    // sin(2 * pi *  574/ 512)
     0.6983762494090,    // sin(2 * pi *  575/ 512)
     0.7071067811865,    // sin(2 * pi *  576/ 512)
     0.7157308252838,    // sin(2 * pi *  577/ 512)
     0.7242470829515,    // sin(2 * pi *  578/ 512)
     0.7326542716724,    // sin(2 * pi *  579/ 512)
     0.7409511253550,    // sin(2 * pi *  580/ 512)
     0.7491363945235,    // sin(2 * pi *  581/ 512)
     0.7572088465065,    // sin(2 * pi *  582/ 512)
     0.7651672656225,    // sin(2 * pi *  583/ 512)
     0.7730104533627,    // sin(2 * pi *  584/ 512)
     0.7807372285721,    // sin(2 * pi *  585/ 512)
     0.7883464276266,    // sin(2 * pi *  586/ 512)
     0.7958369046089,    // sin(2 * pi *  587/ 512)
     0.8032075314806,    // sin(2 * pi *  588/ 512)
     0.8104571982526,    // sin(2 * pi *  589/ 512)
     0.8175848131516,    // sin(2 * pi *  590/ 512)
     0.8245893027850,    // sin(2 * pi *  591/ 512)
     0.8314696123025,    // sin(2 * pi *  592/ 512)
     0.8382247055548,    // sin(2 * pi *  593/ 512)
     0.8448535652497,    // sin(2 * pi *  594/ 512)
     0.8513551931053,    // sin(2 * pi *  595/ 512)
     0.8577286100003,    // sin(2 * pi *  596/ 512)
     0.8639728561216,    // sin(2 * pi *  597/ 512)
     0.8700869911087,    // sin(2 * pi *  598/ 512)
     0.8760700941954,    // sin(2 * pi *  599/ 512)
     0.8819212643484,    // sin(2 * pi *  600/ 512)
     0.8876396204029,    // sin(2 * pi *  601/ 512)
     0.8932243011955,    // sin(2 * pi *  602/ 512)
     0.8986744656940,    // sin(2 * pi *  603/ 512)
     0.9039892931234,    // sin(2 * pi *  604/ 512)
     0.9091679830905,    // sin(2 * pi *  605/ 512)
     0.9142097557035,    // sin(2 * pi *  606/ 512)
     0.9191138516901,    // sin(2 * pi *  607/ 512)
     0.9238795325113,    // sin(2 * pi *  608/ 512)
     0.9285060804732,    // sin(2 * pi *  609/ 512)
     0.9329927988347,    // sin(2 * pi *  610/ 512)
     0.9373390119126,    // sin(2 * pi *  611/ 512)
     0.9415440651830,    // sin(2 * pi *  612/ 512)
     0.9456073253805,    // sin(2 * pi *  613/ 512)
     0.9495281805930,    // sin(2 * pi *  614/ 512)
     0.9533060403542,    // sin(2 * pi *  615/ 512)
     0.9569403357322,    // sin(2 * pi *  616/ 512)
     0.9604305194156,    // sin(2 * pi *  617/ 512)
     0.9637760657954,    // sin(2 * pi *  618/ 512)
     0.9669764710449,    // sin(2 * pi *  619/ 512)
     0.9700312531945,    // sin(2 * pi *  620/ 512)
     0.9729399522056,    // sin(2 * pi *  621/ 512)
     0.9757021300385,    // sin(2 * pi *  622/ 512)
     0.9783173707196,    // sin(2 * pi *  623/ 512)
     0.9807852804032,    // sin(2 * pi *  624/ 512)
     0.9831054874312,    // sin(2 * pi *  625/ 512)
     0.9852776423889,    // sin(2 * pi *  626/ 512)
     0.9873014181579,    // sin(2 * pi *  627/ 512)
     0.9891765099648,    // sin(2 * pi *  628/ 512)
     0.9909026354278,    // sin(2 * pi *  629/ 512)
     0.9924795345987,    // sin(2 * pi *  630/ 512)
     0.9939069700024,    // sin(2 * pi *  631/ 512)
     0.9951847266722,    // sin(2 * pi *  632/ 512)
     0.9963126121828,    // sin(2 * pi *  633/ 512)
     0.9972904566787,    // sin(2 * pi *  634/ 512)
     0.9981181129001,    // sin(2 * pi *  635/ 512)
     0.9987954562052,    // sin(2 * pi *  636/ 512)
     0.9993223845883,    // sin(2 * pi *  637/ 512)
     0.9996988186962,    // sin(2 * pi *  638/ 512)
     0.9999247018391,    // sin(2 * pi *  639/ 512)
     1.0000000000000,    // sin(2 * pi *  640/ 512)
}; 

RTS_DATA_SECTION const float FastRTS_Arctan2Tbl[195] = {
     0.0000000000000F,   1.0000406796754F,  -0.0078110697504F,//   0 -> a0 a1 a2
    -0.0000038070221F,   1.0005280677716F,  -0.0234103454930F,//   1 -> a0 a1 a2
    -0.0000189683103F,   1.0014985681064F,  -0.0389411970749F,//   2 -> a0 a1 a2
    -0.0000528319270F,   1.0029436809648F,  -0.0543585631597F,//   3 -> a0 a1 a2
    -0.0001124179960F,   1.0048507857875F,  -0.0696182066495F,//   4 -> a0 a1 a2
    -0.0002042958852F,   1.0072032932429F,  -0.0846770287235F,//   5 -> a0 a1 a2
    -0.0003344694932F,   1.0099808435012F,  -0.0994933676284F,//   6 -> a0 a1 a2
    -0.0005082726057F,   1.0131595470233F,  -0.1140272784299F,//   7 -> a0 a1 a2
    -0.0007302760352F,   1.0167122634486F,  -0.1282407903432F,//   8 -> a0 a1 a2
    -0.0010042079796F,   1.0206089135568F,  -0.1420981387153F,//   9 -> a0 a1 a2
    -0.0013328887174F,   1.0248168188011F,  -0.1555659692585F,//  10 -> a0 a1 a2
    -0.0017181804313F,   1.0293010625688F,  -0.1686135126670F,//  11 -> a0 a1 a2
    -0.0021609526118F,   1.0340248671352F,  -0.1812127283288F,//  12 -> a0 a1 a2
    -0.0026610631593F,   1.0389499802219F,  -0.1933384164099F,//  13 -> a0 a1 a2
    -0.0032173549768F,   1.0440370651602F,  -0.2049682981460F,//  14 -> a0 a1 a2
    -0.0038276675461F,   1.0492460888683F,  -0.2160830647060F,//  15 -> a0 a1 a2
    -0.0044888627021F,   1.0545367021923F,  -0.2266663955068F,//  16 -> a0 a1 a2
    -0.0051968635789F,   1.0598686075727F,  -0.2367049472787F,//  17 -> a0 a1 a2
    -0.0059467055004F,   1.0652019095265F,  -0.2461883156129F,//  18 -> a0 a1 a2
    -0.0067325974217F,   1.0704974439939F,  -0.2551089710223F,//  19 -> a0 a1 a2
    -0.0075479924132F,   1.0757170832221F,  -0.2634621718398F,//  20 -> a0 a1 a2
    -0.0083856655986F,   1.0808240134986F,  -0.2712458564756F,//  21 -> a0 a1 a2
    -0.0092377979239F,   1.0857829836932F,  -0.2784605176930F,//  22 -> a0 a1 a2
    -0.0100960641391F,   1.0905605232115F,  -0.2851090616505F,//  23 -> a0 a1 a2
    -0.0109517234066F,   1.0951251285570F,  -0.2911966544475F,//  24 -> a0 a1 a2
    -0.0117957110286F,   1.0994474183038F,  -0.2967305589200F,//  25 -> a0 a1 a2
    -0.0126187298731F,   1.1035002567840F,  -0.3017199643105F,//  26 -> a0 a1 a2
    -0.0134113401986F,   1.1072588472740F,  -0.3061758113249F,//  27 -> a0 a1 a2
    -0.0141640467111F,   1.1107007958875F,  -0.3101106149475F,//  28 -> a0 a1 a2
    -0.0148673818311F,   1.1138061477170F,  -0.3135382871760F,//  29 -> a0 a1 a2
    -0.0155119842982F,   1.1165573970591F,  -0.3164739616554F,//  30 -> a0 a1 a2
    -0.0160886723953F,   1.1189394737663F,  -0.3189338219481F,//  31 -> a0 a1 a2
    -0.0165885112292F,   1.1209397079557F,  -0.3209349349913F,//  32 -> a0 a1 a2
    -0.0170028736449F,   1.1225477753665F,  -0.3224950910217F,//  33 -> a0 a1 a2
    -0.0173234944993F,   1.1237556257493F,  -0.3236326510678F,//  34 -> a0 a1 a2
    -0.0175425181404F,   1.1245573966328F,  -0.3243664028596F,//  35 -> a0 a1 a2
    -0.0176525390650F,   1.1249493148104F,  -0.3247154258333F,//  36 -> a0 a1 a2
    -0.0176466358231F,   1.1249295877727F,  -0.3246989656827F,//  37 -> a0 a1 a2
    -0.0175183983443F,   1.1244982872665F,  -0.3243363187867F,//  38 -> a0 a1 a2
    -0.0172619489202F,   1.1236572269554F,  -0.3236467266133F,//  39 -> a0 a1 a2
    -0.0168719571636F,   1.1224098360981F,  -0.3226492801386F,//  40 -> a0 a1 a2
    -0.0163436492943F,   1.1207610309185F,  -0.3213628341191F,//  41 -> a0 a1 a2
    -0.0156728121663F,   1.1187170852579F,  -0.3198059310243F,//  42 -> a0 a1 a2
    -0.0148557924513F,   1.1162855018516F,  -0.3179967342794F,//  43 -> a0 a1 a2
    -0.0138894914410F,   1.1134748854835F,  -0.3159529704599F,//  44 -> a0 a1 a2
    -0.0127713559110F,   1.1102948190320F,  -0.3136918799664F,//  45 -> a0 a1 a2
    -0.0114993655128F,   1.1067557433290F,  -0.3112301757137F,//  46 -> a0 a1 a2
    -0.0100720171306F,   1.1028688415306F,  -0.3085840092872F,//  47 -> a0 a1 a2
    -0.0084883066548F,   1.0986459286453F,  -0.3057689440639F,//  48 -> a0 a1 a2
    -0.0067477085786F,   1.0940993466476F,  -0.3027999347241F,//  49 -> a0 a1 a2
    -0.0048501538149F,   1.0892418655233F,  -0.2996913126099F,//  50 -> a0 a1 a2
    -0.0027960061186F,   1.0840865905167F,  -0.2964567764093F,//  51 -> a0 a1 a2
    -0.0005860374406F,   1.0786468756663F,  -0.2931093876086F,//  52 -> a0 a1 a2
     0.0017785974517F,   1.0729362437272F,  -0.2896615702293F,//  53 -> a0 a1 a2
     0.0042963868040F,   1.0669683124404F,  -0.2861251143513F,//  54 -> a0 a1 a2
     0.0069654878940F,   1.0607567270642F,  -0.2825111829598F,//  55 -> a0 a1 a2
     0.0097837530165F,   1.0543150990086F,  -0.2788303216685F,//  56 -> a0 a1 a2
     0.0127487552067F,   1.0476569504397F,  -0.2750924709426F,//  57 -> a0 a1 a2
     0.0158578135459F,   1.0407956645818F,  -0.2713069804113F,//  58 -> a0 a1 a2
     0.0191080178933F,   1.0337444414765F,  -0.2674826249277F,//  59 -> a0 a1 a2
     0.0224962528869F,   1.0265162589889F,  -0.2636276220892F,//  60 -> a0 a1 a2
     0.0260192211618F,   1.0191238386511F,  -0.2597496508597F,//  61 -> a0 a1 a2
     0.0296734656363F,   1.0115796161864F,  -0.2558558711062F,//  62 -> a0 a1 a2
     0.0334553908381F,   1.0038957163225F,  -0.2519529437632F,//  63 -> a0 a1 a2
     0.0373612832121F,   0.9960839316110F,  -0.2480470514256F,//  64 -> a0 a1 a2
}; 

RTS_DATA_SECTION const float FastRTS_expTable[89] = {
    1.0000000000000e+00F, // exp(  0)
    2.7182817459106e+00F, // exp(  1)
    7.3890562057495e+00F, // exp(  2)
    2.0085536956787e+01F, // exp(  3)
    5.4598152160645e+01F, // exp(  4)
    1.4841316223145e+02F, // exp(  5)
    4.0342880249023e+02F, // exp(  6)
    1.0966331787109e+03F, // exp(  7)
    2.9809580078125e+03F, // exp(  8)
    8.1030839843750e+03F, // exp(  9)
    2.2026464843750e+04F, // exp( 10)
    5.9874140625000e+04F, // exp( 11)
    1.6275479687500e+05F, // exp( 12)
    4.4241337500000e+05F, // exp( 13)
    1.2026042500000e+06F, // exp( 14)
    3.2690175000000e+06F, // exp( 15)
    8.8861110000000e+06F, // exp( 16)
    2.4154952000000e+07F, // exp( 17)
    6.5659968000000e+07F, // exp( 18)
    1.7848230400000e+08F, // exp( 19)
    4.8516518400000e+08F, // exp( 20)
    1.3188157440000e+09F, // exp( 21)
    3.5849128960000e+09F, // exp( 22)
    9.7448038400000e+09F, // exp( 23)
    2.6489122816000e+10F, // exp( 24)
    7.2004902912000e+10F, // exp( 25)
    1.9572962099200e+11F, // exp( 26)
    5.3204824883200e+11F, // exp( 27)
    1.4462570987520e+12F, // exp( 28)
    3.9313342464000e+12F, // exp( 29)
    1.0686474223616e+13F, // exp( 30)
    2.9048849825792e+13F, // exp( 31)
    7.8962956959744e+13F, // exp( 32)
    2.1464357430886e+14F, // exp( 33)
    5.8346171059405e+14F, // exp( 34)
    1.5860134450299e+15F, // exp( 35)
    4.3112315318436e+15F, // exp( 36)
    1.1719142537167e+16F, // exp( 37)
    3.1855931348222e+16F, // exp( 38)
    8.6593404045099e+16F, // exp( 39)
    2.3538527034042e+17F, // exp( 40)
    6.3984347447611e+17F, // exp( 41)
    1.7392749753422e+18F, // exp( 42)
    4.7278395262973e+18F, // exp( 43)
    1.2851599879818e+19F, // exp( 44)
    3.4934270576908e+19F, // exp( 45)
    9.4961195300688e+19F, // exp( 46)
    2.5813128932181e+20F, // exp( 47)
    7.0167362905576e+20F, // exp( 48)
    1.9073464997854e+21F, // exp( 49)
    5.1847054576655e+21F, // exp( 50)
    1.4093490364499e+22F, // exp( 51)
    3.8310081899410e+22F, // exp( 52)
    1.0413759887482e+23F, // exp( 53)
    2.8307533984544e+23F, // exp( 54)
    7.6947854714906e+23F, // exp( 55)
    2.0916594490409e+24F, // exp( 56)
    5.6857200220030e+24F, // exp( 57)
    1.5455390078758e+25F, // exp( 58)
    4.2012104528050e+25F, // exp( 59)
    1.1420073962419e+26F, // exp( 60)
    3.1042977826582e+26F, // exp( 61)
    8.4383568232726e+26F, // exp( 62)
    2.2937831182341e+27F, // exp( 63)
    6.2351494320497e+27F, // exp( 64)
    1.6948892066757e+28F, // exp( 65)
    4.6071865476425e+28F, // exp( 66)
    1.2523631854447e+29F, // exp( 67)
    3.4042761729011e+29F, // exp( 68)
    9.2537816213739e+29F, // exp( 69)
    2.5154387003559e+30F, // exp( 70)
    6.8376711375563e+30F, // exp( 71)
    1.8586717056324e+31F, // exp( 72)
    5.0523935602179e+31F, // exp( 73)
    1.3733829622695e+32F, // exp( 74)
    3.7332418496475e+32F, // exp( 75)
    1.0148004187492e+33F, // exp( 76)
    2.7585135499700e+33F, // exp( 77)
    7.4984169815783e+33F, // exp( 78)
    2.0382810254658e+34F, // exp( 79)
    5.5406224846768e+34F, // exp( 80)
    1.5060972626944e+35F, // exp( 81)
    4.0939968518217e+35F, // exp( 82)
    1.1128637275465e+36F, // exp( 83)
    3.0250773415263e+36F, // exp( 84)
    8.2230123930183e+36F, // exp( 85)
    2.2352465286716e+37F, // exp( 86)
    6.0760303473996e+37F, // exp( 87)
    1.6516362661361e+38F, // exp( 88)
}; 

RTS_DATA_SECTION const float FastRTS_logTable[99] = {
     0.0000000000000,   0.9998427992674,  -0.4847911018021,//   0 -> a0 a1 a2
     0.0000275291995,   0.9980708040346,  -0.4562771546109,//   1 -> a0 a1 a2
     0.0001288044413,   0.9948210100411,  -0.4302069126207,//   2 -> a0 a1 a2
     0.0003380953764,   0.9903481346473,  -0.4063088992594,//   3 -> a0 a1 a2
     0.0006803358416,   0.9848651381166,  -0.3843483167891,//   4 -> a0 a1 a2
     0.0011731595065,   0.9785505884417,  -0.3641212561818,//   5 -> a0 a1 a2
     0.0018284930657,   0.9715546054665,  -0.3454499459991,//   6 -> a0 a1 a2
     0.0026538075361,   0.9640036832441,  -0.3281788325266,//   7 -> a0 a1 a2
     0.0036531040203,   0.9560046214281,  -0.3121713290093,//   8 -> a0 a1 a2
     0.0048276922798,   0.9476477450549,  -0.2973071065684,//   9 -> a0 a1 a2
     0.0061768069432,   0.9390095529690,  -0.2834798260461,//  10 -> a0 a1 a2
     0.0076980959745,   0.9301549052016,  -0.2705952306243,//  11 -> a0 a1 a2
     0.0093880082817,   0.9211388365590,  -0.2585695350951,//  12 -> a0 a1 a2
     0.0112421014268,   0.9120080657950,  -0.2473280602005,//  13 -> a0 a1 a2
     0.0132552858594,   0.9028022558110,  -0.2368040703340,//  14 -> a0 a1 a2
     0.0154220185869,   0.8935550694019,  -0.2269377807187,//  15 -> a0 a1 a2
     0.0177364564779,   0.8842950564587,  -0.2176755063963,//  16 -> a0 a1 a2
     0.0201925772769,   0.8750464017178,  -0.2089689303380,//  17 -> a0 a1 a2
     0.0227842747501,   0.8658295567283,  -0.2007744720005,//  18 -> a0 a1 a2
     0.0255054330825,   0.8566617753623,  -0.1930527408698,//  19 -> a0 a1 a2
     0.0283499846180,   0.8475575687189,  -0.1857680621711,//  20 -> a0 a1 a2
     0.0313119542237,   0.8385290924587,  -0.1788880640520,//  21 -> a0 a1 a2
     0.0343854929130,   0.8295864773384,  -0.1723833173021,//  22 -> a0 a1 a2
     0.0375649028492,   0.8207381118556,  -0.1662270200986,//  23 -> a0 a1 a2
     0.0408446554406,   0.8119908844263,  -0.1603947214664,//  24 -> a0 a1 a2
     0.0442194039060,   0.8033503912691,  -0.1548640781109,//  25 -> a0 a1 a2
     0.0476839914351,   0.7948211151512,  -0.1496146400928,//  26 -> a0 a1 a2
     0.0512334558374,   0.7864065793495,  -0.1446276615129,//  27 -> a0 a1 a2
     0.0548630314249,   0.7781094804378,  -0.1398859329117,//  28 -> a0 a1 a2
     0.0585681487095,   0.7699318029982,  -0.1353736325973,//  29 -> a0 a1 a2
     0.0623444324097,   0.7618749188190,  -0.1310761944828,//  30 -> a0 a1 a2
     0.0661876981423,   0.7539396728045,  -0.1269801903868,//  31 -> a0 a1 a2
     0.0700939481277,   0.7461264574323,  -0.1230732250001,//  32 -> a0 a1 a2
}; 

/* ========================================================================== */
/*                          Functions                                         */
/* ========================================================================== */

RTS_TEXT_SECTION float FastRTS_cosf(const float theta)
{
    // Locals
    int32_t k;
    float x, kf, res;
    const float *S = &FastRTS_SinCosTbl[0];
    const float *C = &FastRTS_SinCosTbl[SINCOS_TBLSIZE/4U];
    
    // Calculate the floating point index into the table
    kf = theta * RAD_ISTEP;
    // Calculate the signed integer index into the table
    k = (int32_t)(kf);
    // Calculate the fractional portion of theta that lies
    // between two table indices
    x = (kf - k) * RAD_STEP;
    // Negative values must wrap around and access the table from the end
    k = k & (SINCOS_TBLSIZE - 1U);
    // The cosine is given by the Taylor Series Expansion of the cosine
    res = C[k] + x*(-SINCOS_A0*S[k] + x*(-SINCOS_A1*C[k] + SINCOS_A2*x*S[k]));

    return(res);
}

RTS_TEXT_SECTION float FastRTS_sinf(const float theta)
{
    // Locals
    int32_t k;
    float x, kf, res;
    const float *S = &FastRTS_SinCosTbl[0];
    const float *C = &FastRTS_SinCosTbl[SINCOS_TBLSIZE/4U];
    
    // Calculate the floating point index into the table
    kf = theta * RAD_ISTEP;
    // Calculate the signed integer index into the table
    k = (int32_t)(kf);
    // Calculate the fractional portion of theta that lies
    // between two table indices
    x = (kf - k) * RAD_STEP;
    // Negative values must wrap around and access the table from the end
    k = k & (SINCOS_TBLSIZE - 1U);
    // The sine is given by the Taylor Series Expansion of the sine
    res = S[k] + x*(SINCOS_A0*C[k] + x*(-SINCOS_A1*S[k] + -SINCOS_A2*x*C[k]));

    return(res);
}

RTS_TEXT_SECTION void FastRTS_sincos(const float theta, float *retValues)
{
    // Locals
    int32_t k;
    float x, kf;
    
    const float *S = &FastRTS_SinCosTbl[0];
    const float *C = &FastRTS_SinCosTbl[SINCOS_TBLSIZE/4U];
    
    // Calculate the floating point index into the table
    kf = theta * RAD_ISTEP;
    // Calculate the signed integer index into the table
    k = (int32_t)(kf);
    // Calculate the fractional portion of theta that lies
    // between two table indices
    x = (kf - k) * RAD_STEP;
    // Negative values must wrap around and access the table from the end
    k = k & (SINCOS_TBLSIZE - 1U);
    // The sine/cosine is given by the Taylor Series Expansion of the
    // sine/cosine
    retValues[0] = S[k] + x*( SINCOS_A0*C[k] + x*(-SINCOS_A1*S[k] + -SINCOS_A2*x*C[k]));
    retValues[1] = C[k] + x*(-SINCOS_A0*S[k] + x*(-SINCOS_A1*C[k] +  SINCOS_A2*x*S[k]));

}

RTS_TEXT_SECTION float FastRTS_asinf(const float x)
{
    float asinApprox, sqrtx, absX;
    int32_t sign = 1.0f;

    absX = x;
    if (absX < 0.0f)
    {
        absX = -absX;
        sign = -1.0f;
    }

    sqrtx = 1 - absX;
    sqrtx = FastRTS_sqrtf(sqrtx);

    float x2 = absX * absX;

    asinApprox = ASINCOS_A0;
    asinApprox += ASINCOS_A1 * absX;

    float x3 = x2 * absX;
    float x4 = x2 * x2;
    float x5 = x2 * x3;
    float x6 = x3 * x3;

    asinApprox += ASINCOS_A2 * x2;
    asinApprox += ASINCOS_A3 * x3;
    asinApprox += ASINCOS_A4 * x4;
    asinApprox += ASINCOS_A5 * x5;
    asinApprox += ASINCOS_A6 * x6;

    asinApprox *= sqrtx;

    asinApprox = sign * (PI_O_2 - asinApprox);

    return asinApprox;
}

RTS_TEXT_SECTION float FastRTS_acosf(const float x)
{
    float acosApprox, sqrtx, absX;
    int32_t sign = 1.0f;

    absX = x;
    if (absX < 0.0f)
    {
        absX = -absX;
        sign = -1.0f;
    }

    sqrtx = 1 - absX;
    sqrtx = FastRTS_sqrtf(sqrtx);

    float x2 = absX * absX;

    acosApprox = ASINCOS_A0;
    acosApprox += ASINCOS_A1 * absX;
    float x3 = x2 * absX;
    float x4 = x2 * x2;
    float x5 = x2 * x3;
    float x6 = x3 * x3;

    acosApprox += ASINCOS_A2 * x2;
    acosApprox += ASINCOS_A3 * x3;
    acosApprox += ASINCOS_A4 * x4;
    acosApprox += ASINCOS_A5 * x5;
    acosApprox += ASINCOS_A6 * x6;

    acosApprox *= sqrtx;

    acosApprox = sign * (PI_O_2 - acosApprox);
    acosApprox = PI_O_2 - acosApprox;

    return acosApprox;
}

RTS_TEXT_SECTION float FastRTS_atanf(const float x)
{
    // Locals
    int32_t k;
    float r, a0, a1, a2, res;
    
    r = fabsf(x);

    // Reduce the xument to the range [-1,1]
    if(r > 1.0f)
    {
        r = 1.0f / r;
    }
    
    // Calculate the index into the lookup table, the table 
    // is a set of 3-tuples
    k = (uint32_t)(r * ARCTAN2_TBLSIZE);
    k = k * 3U;
    // Get the coefficients
    a0 = FastRTS_Arctan2Tbl[k++];
    a1 = FastRTS_Arctan2Tbl[k++];
    a2 = FastRTS_Arctan2Tbl[k++];
    // Calculate the arctangent for the first quadrant
    // 0 to +pi/4 (x > 0 && |x| <= 1.0)
    res = a0 + r*(a1 + a2*r);
    
    if(fabsf(x) > 1.0f)
    {
        // if the argument lies in the first quadrant
        // +pi/4 to +pi/2, then we would have calculated
        // arctan(1/|x|). We can use the identity
        // arctan(x) = pi/2 - arctan(1/|x|)
        res = PI_O_2 - res;
    }

    if(x < 0.0f)
    {
        // if the argument lies in the second quadrant
        // we use the identity arctan(-|x|) = -arctan(|x|).
        res = -res;
    }

    return(res);
}

RTS_TEXT_SECTION float FastRTS_atan2f(const float y, const float x)
{
    // Locals
    int32_t k;
    float r, a0, a1, a2, res;
    
    // Reduce the argument to the range [-1,1]
    if(fabsf(x) >= fabsf(y))
    {
        r = fabsf(y)/fabsf(x);
    }
    else
    {
        r = fabsf(x)/fabsf(y);
    }
    
    // Calculate the index into the lookup table, the table 
    // is a set of 3-tuples
    k = (uint32_t)(r * ARCTAN2_TBLSIZE);
    k = k * 3U;
    // Get the coefficients
    a0 = FastRTS_Arctan2Tbl[k++];
    a1 = FastRTS_Arctan2Tbl[k++];
    a2 = FastRTS_Arctan2Tbl[k++];
    // Calculate the arctangent for the first quadrant
    // 0 to +pi/4 (x,y > 0 && |x| >= |y|)
    res = a0 + r*(a1 + a2*r);
    
    if((x >= 0) && (fabsf(x) < fabsf(y)))
    {
        // The argument y/x lies in the first Quadrant (pi/4 to pi/2)
        // Since |y|>|x|, we calculate arctan(|x|/|y|). We use the identity,
        // arctan(y/x) = pi/2 - arctan(|x|/|y|)
        res = PI_O_2 - res;
    }
    if ((x < 0) && (fabsf(x) < fabsf(y)))
    {
        // The argument y/x lies in the Second quadrant (pi/2 to 3pi/4)
        // Since |y|>|x| and x<0, we calculate arctan(|x|/|y|). We use the
        // identity,
        // arctan(y/x) = pi/2 - arctan(-|x|/|y|)
        //             = pi/2 - -arctan(|x|/|y|)
        //             = pi/2 + arctan(|x|/|y|)
        res = PI_O_2 + res;
    }
    if ((x < 0) && (fabsf(x) >= fabsf(y)))
    {
        // The argument y/x lies in the Second quadrant (3pi/4 to pi)
        // Since |y|<=|x| and x<0, we calculate arctan(|y|/|x|). We use the
        // identity,
        // arctan(y/x) = arctan(|y|/-|x|)
        //             = -arctan(|y|/|x|)
        // We want to represent angles in the range [0,pi] as positive,
        // we must therefore "unwrap" this angle
        // arctan(y/x) = pi - arctan(|y|/|x|)
        res = PI - res;
    }
    if ( y < 0 ) 
    {
        // If the argument y/x lies in the third and fourth quadrants,
        // it is the exact mirror of what we have already calculated
        res = -res;
    }

    return(res);
}

RTS_TEXT_SECTION float FastRTS_expf(const float x)
{
    // Locals
    float x_a    = fabsf(x);
    // Separate the integer and fractional portion of the input
    int32_t x_i  = x_a;
    float x_f = x_a - x_i;

    // Get e^integer(x) from the table
    float e_intx = FastRTS_expTable[x_i];
    // Calculate e^(fraction) by using the Taylor series expansion for
    // exponents
    //   x
    // e   = 1 + x*(1+x/2*(1+x/3*(1+x/4*(1+x/5*(1+x/6*(1+x/7)+...)))))
    // 
    float e_fracx = 1 + x_f*(1 + x_f*FPUINV2  *
                              (1 + x_f*FPUINV3  *
                              (1 + x_f*FPUINV4  *
                              (1 + x_f*FPUINV5  *
                              (1 + x_f*FPUINV6  *
                              (1 + x_f*FPUINV7))))));

    //  The result,  e^{x} = e^{integer}*e^{fraction}
    float e_x = e_intx * e_fracx;
    
    // If x was negative, calculate the inverse of the result
    if(x < 0.0f)
    {
        e_x = 1.0f / e_x;
    }

    return(e_x);
}

RTS_TEXT_SECTION float FastRTS_logf(const float x)
{
    // Locals
    float x_a = fabsf(x);
    //  A floating point number is represented as 
    //       X=[S]1.M*2^E 
    // where S is the  sign bit, M the mantissa, and E the biased exponent. 
    // The natural logarithm of such a number is given by
    //      log(X)= log(1.M)+ E*log(2)
    union fisize_t{
        float f;
        int32_t i;
    }x_exp, x_mant;
    
    x_exp.f  = x_a;
    x_mant.f = x_a;
    
    // Separate the exponent of X and store as a float
    x_exp.f = (float)(x_exp.i >> (FLT_MANT_DIG - 1)) - FPUEXPBIAS;
    
    float log_exp = x_exp.f * FPULOG2;
    
    // Separate the mantissa (1.M), and then the fractional portion Xm = M
    // ANDing the argument with FPULOG_TABLE_MASK1 will zero out the sign
    // and most significant exponent bit, while ORing with FPULOG_TABLE_MASK2
    // will set the exponent to 127 (single) or 1023 (double)
    //
    // Consider 10 = 1.25x2^3. In single precision float the leading 1 of the 
    // significand is implicit and the exponent is biased around 127, so its 
    // physical representation is 
    //   31|30           23|22                                        0|
    //   +-+---------------+-------------------------------------------+
    //   |0|1|0|0|0|0|0|1|0|0|1|0                 ...........         0|
    //   +-+---------------+-------------------------------------------+
    //    S| biased exp    | mantissa                                  |
    //     | E = 127+3=131 | 0.25                                      |
    //
    // X & 0x3FFFFFFF
    //   31|30           23|22                                        0|
    //   +-+---------------+-------------------------------------------+
    //   |0|0|0|0|0|0|0|1|0|0|1|0                 ...........         0|
    //   +-+---------------+-------------------------------------------+
    //    S| biased exp    | mantissa                                  |
    //     | E = 2         | 0.25                                      |
    // (X & 0x3FFFFFFF) | 0x3F800000
    //   31|30           23|22                                        0|
    //   +-+---------------+-------------------------------------------+
    //   |0|0|1|1|1|1|1|1|1|0|1|0                 ...........         0|
    //   +-+---------------+-------------------------------------------+
    //    S| biased exp    | mantissa                                  |
    //     | E = 127       | 0.25                                      |    
    // Now the value of this float (after removing exponent bias)
    //   = 1.25 * 2^(127-127(BIAS)) = 1.25
    // We have extracted just the mantissa (or significand)
    x_mant.i = (x_mant.i & (int32_t)FPULOG_TABLE_MASK1) | 
                           (int32_t)FPULOG_TABLE_MASK2;
    // Get the fractional part of the mantissa
    x_mant.f = x_mant.f - 1.0;
    
    // The value of log(1.M) = A0 + M*(A1 + M*A2), where M is the 
    // fractional part of the mantissa extracted in the previous step
    // The values A0, A1, A2 are a triplet that is obtained from the 
    // lookup table; the table has LOG_TBLSIZE such triplets
    int32_t i = (int32_t)(x_mant.f * LOG_TBLSIZE);
    i *= 3;
    
    float A0 = FastRTS_logTable[i];
    float A1 = FastRTS_logTable[i + 1];
    float A2 = FastRTS_logTable[i + 2];
    
    float log_mant = A0 + x_mant.f*(A1 + x_mant.f*A2);
    float log_x    = log_exp + log_mant;
    
    return(log_x);
}
